<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>What is a parser? - Writing an Interpreter in Rust</title>
        <!-- Custom HTML head -->
<!-- Fathom - beautiful, simple website analytics -->
<script src="https://cdn.usefathom.com/script.js" data-site="VRBABWHG" defer></script>
<!-- / Fathom -->        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../the-language.html"><strong aria-hidden="true">2.</strong> The Language</a></li><li class="chapter-item expanded affix "><li class="part-title">Setup</li><li class="chapter-item expanded "><a href="../setup/creating-a-cargo-project.html"><strong aria-hidden="true">3.</strong> Creating a Cargo project</a></li><li class="chapter-item expanded affix "><li class="part-title">Parsing</li><li class="chapter-item expanded "><a href="../parsing/what-is-a-parser.html" class="active"><strong aria-hidden="true">4.</strong> What is a parser?</a></li><li class="chapter-item expanded "><a href="../parsing/installing-lalrpop.html"><strong aria-hidden="true">5.</strong> Installing LALRPOP</a></li><li class="chapter-item expanded "><a href="../parsing/your-first-node.html"><strong aria-hidden="true">6.</strong> Your first node</a></li><li class="chapter-item expanded "><a href="../parsing/parsing-a-let-statement.html"><strong aria-hidden="true">7.</strong> Parsing a &quot;let&quot; statement</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Writing an Interpreter in Rust</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-a-parser"><a class="header" href="#what-is-a-parser">What is a parser?</a></h1>
<p>If you did a computer science course at university, chances are you've spent a decent amount of time learning about parsers. If that's you, feel free to skip over this chapter.</p>
<p>If you <em>don't</em> know what a parser is, keep on reading. I'll do my best to explain things simply.</p>
<h2 id="tokens"><a class="header" href="#tokens">Tokens</a></h2>
<p>Essentially every programming language begins by breaking your code down into tokens.</p>
<p>Let's assume we have a JavaScript-like language.</p>
<pre><code class="language-js">let name = &quot;Ryan&quot;;
</code></pre>
<p>We naturally give each word and character in the code a name. We'd call <code>let</code> a <strong>keyword</strong>, <code>name</code> would be an <strong>identifier</strong> and <code>&quot;Ryan&quot;</code> would be a <strong>string</strong>.</p>
<p>The names we assign to each word and character are known as of token types.</p>
<pre><code class="language-php">T_LET       &quot;let&quot;
T_IDENT     &quot;name&quot;
T_ASSIGN    &quot;=&quot;
T_STRING    &quot;Ryan&quot;
</code></pre>
<p>Keywords tend to have more specific names than <code>T_KEYWORD</code>. This becomes useful when we start processing our stream of tokens.</p>
<h2 id="parsing"><a class="header" href="#parsing">Parsing</a></h2>
<p>Once the code has been broken down into a list of tokens, we can start processing and analysing the tokens. </p>
<p>A parser will look at each token in our source and generate a formal data structure to represent the logical structure and flow of our program.</p>
<p>The simplest of parsers will look at the current token and make some assertions on the next token in the list. Using the code example from above, we can use the flowchart below to demonstrate our logic.</p>
<pre><code class="language-mermaid">flowchart TD;
    T_LET[Found T_LET] --&gt; IS_T_IDENT[Is it an identifier?]
    IS_T_IDENT --&gt;|No?| ERROR_T_IDENT[Error, expected T_IDENT]
    IS_T_IDENT --&gt;|Yes?| READ_T_IDENT[Store identifier]
    READ_T_IDENT --&gt; READ_NEXT_T[Read next token]
    READ_NEXT_T --&gt;|No?| EXIT_EARLY_ASSIGN[Early return, no default value]
    READ_NEXT_T --&gt;|Yes?| READ_T_ASSIGN[Skip T_ASSIGN]
    READ_T_ASSIGN --&gt; EXPECT_EXPRESSION[Has value after T_ASSIGN?]
    EXPECT_EXPRESSION --&gt;|No?| ERROR_EXPR[Error, expected value after T_ASSIGN]
    EXPECT_EXPRESSION --&gt;|Yes?| READ_VALUE[Parse value and store]
</code></pre>
<p>This is a high-level description of how a parser, well, parses. After each token, it checks a couple of conditions and determines what the next move is.</p>
<p>At any point in time, the parser could find a problem. This is when you'll come across <em>&quot;Parse error&quot;</em> or similar in your favourite programming languages.</p>
<p>Once the parser has analysed all of the tokens, it will return a tree structure that represents the logical flow of your program. This is called an <strong>Abstract Syntax-Tree</strong> (AST).</p>
<p>At the top-level, an AST is a list of top-level <strong>nodes</strong>. Each nodes is a different piece of logic in the program.</p>
<p>A node can also store other nodes. This is more common when looking at conditional logic, such as the code that executes when an <code>if</code> statement's condition evaluates to <code>true</code>. </p>
<p>If we were to represent our <code>let</code> statement as a node, using JSON, it would probably look like this:</p>
<pre><code class="language-json">{
    &quot;type&quot;: &quot;LetStatement&quot;,
    &quot;name&quot;: &quot;name&quot;,
    &quot;value&quot;: {
        &quot;type&quot;: &quot;StringLiteral&quot;,
        &quot;value&quot;: &quot;Ryan&quot;,
    },
    &quot;line&quot;: 1
}
</code></pre>
<p>Our <code>LetStatement</code> node stores a <code>name</code> and <code>value</code>, both of which were retrieved by the parser in the flowchart above. What's special about the <code>value</code> key is that it stores another node. Our code set the value of the <code>name</code> variable to <code>Ryan</code> which is a <code>StringLiteral</code>.</p>
<h3 id="parser-generators"><a class="header" href="#parser-generators">Parser generators</a></h3>
<p>If you've done any amount of research into programming language design and development, you've likely come across this term before.</p>
<p>Parser generators are specialised tools that normally provide their own domain-specific language for writing a parser. You use a specialised grammar to define the tokens and structures in your code and the parser generator will generate a parser for you in your host language, i.e. Rust.</p>
<p>We'll actually be using a parser generator (<a href="https://github.com/lalrpop/lalrpop">LALRPOP</a>) in this book to get started with our tree-walk interpreter. Once we have a good amount of test coverage, we'll come back and replace it with a custom parser.</p>
<p>Parser generators can save you a lot of time when developing a programming language - there are plenty of hugely popular languages that still use them to this day. The argument between using one of these generator tools or writing your parser is controversial, like most things in programming. I would generally recommend starting with a parser generator and moving to a hand-written one when the potential performance benefits and control are truly beneficial.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../setup/creating-a-cargo-project.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../parsing/installing-lalrpop.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../setup/creating-a-cargo-project.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../parsing/installing-lalrpop.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../mermaid.min.js"></script>
        <script type="text/javascript" src="../mermaid-init.js"></script>
    </body>
</html>
